
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd"
    >
<html lang="es">
<head>
    <title>Probando el comportamiento droppable de jQueryUI</title>
	<link type="text/css" href="../css/blitzer/jquery-ui-1.8.18.custom.css" rel="Stylesheet" id="linkestilo" /> 
	<link rel="stylesheet" href="css/main.css">     
	<script src="../../libs/js/jquery-1.11.0.min.js"></script>
    <script src="../../libs/js/jquery-ui.1.10.4.min.js"></script>	
	<style type="text/css">
	body{
		background-color: #fc9;
		font-family: sans-serif;
		font-size: 0.875em;
		width: 940px;
		margin: 0 auto;
		height: 600px;
		border: 1px solid #ccc;
	}
	
	</style>
	<script type="text/javascript">

		function aleatorio(inferior,superior){ 
			numPosibilidades = superior - inferior 
			aleat = Math.random() * numPosibilidades 
			aleat = Math.floor(aleat) 
			return parseInt(inferior) + aleat 
		} 
		
		$(document).ready(function(){

 //words = ['D', 'U'],
 words = ['D', 'U'],
 numbers = '22',
 contenedor = $('body');
 cuentaBotones = 0;

for ( var i=0; i<numbers.length; i++ ) {
	$('body').append('<button id="' + words[i]  +'" class="creaelemento">Crea ' + words[i]  +'</button><div id="suelta' + words[i]  +'" class="suelta"></div>').find('#suelta'+ words[i]).show().attr('data-cuenta' , numbers[i]);
 };

	
			//defino los elementos que se pueden arrastrar
			$(".arrastrable").draggable();
			$(".arrastrable").data("soltado", false);
			
			//voy a crear una variable para contar los elementos que estoy soltando
			$(".suelta").data("numsoltar", 0);
			//defino elementos donde se puede soltar
			$(".suelta").droppable({
				drop: function( event, ui ) {
						var elem = $(this);
						console.log(elem);
						cuenta = elem.data("numsoltar");
						cuentaCajon = elem.data('cuenta');
						id = elem.attr('id').split('suelta');
						console.log(id[1]);

						if(cuenta != cuentaCajon){	
							if (!ui.draggable.data("soltado")){
								ui.draggable.data("soltado", true);
								elem.data("numsoltar", elem.data("numsoltar") + 1)
								elem.html("Llevo " + elem.data("numsoltar") + " elementos soltados");

							}
						}else{
							elementos = $('.arrastrable');
						    elementos.draggable({
						    	cursor: 'move',
      							revert: true
						    });
						    $('button#'+id[1]).attr("disabled", "disabled").css({
						    	opacity: '0.5',
						    });

							if($('.creaelemento').is(":disabled")){
								cuentaBotones + 1;
							}

							if(cuentaBotones==$('.creaelemento').length){
								console.log('sadasd');
							}

						}//if	
				},
				out: function( event, ui ) {
					if (ui.draggable.data("soltado")){
						ui.draggable.data("soltado", false);
						var elem = $(this);
						elem.data("numsoltar", elem.data("numsoltar") - 1);
						elem.html("Llevo " + elem.data("numsoltar") + " elementos soltados");
					}
				}
			});
			
			//soltar solo elementos Ds
			$("#sueltaD").droppable("option", "accept", ".D");
			//soltar solo elementos Ues
			$("#sueltaU").droppable("option", "accept", ".U");
			
			//enlaces para crear nuevos elementos Ds y Ues
			$(".creaelemento").click(function(e){
				e.preventDefault();
				//var posx = aleatorio(10, 30);
				//var posy = aleatorio(20, 50);
				var nuevoElemento = $('<div class="' + $(this).attr("id") + ' arrastrable" style="top: 5px; left:5px;"></div>');
				nuevoElemento.draggable();
				$(document.body).append(nuevoElemento);
			})

				


		})
	</script>
</head>
<body>
	
	<!--<a href="D" class="creaelemento">Crea un elemento D</a> 
	<a href="U" class="creaelemento">Crea un elemento U</a> 
	

	
	<div class="U arrastrable" style="top: 140px; left: 150px;"></div>
	<div class="D arrastrable" style="top: 98px; left: 100px;"></div>
	<div class="D arrastrable" style="top: 120px; left: 180px;"></div>
	<div class="U arrastrable" style="top: 120px; left: 90px;"></div>-->
	<div id="cuadros">
	<div id="sueltaD" class="suelta">
		Suelta aquí elementos Ds
	</div>
	<div id="sueltaU" class="suelta">
		Suelta aquí elementos Ues
	</div>
	</div>


</body>
</html>

