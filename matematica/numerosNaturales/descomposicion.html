<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/main.css">
        <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 9]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
      <div class="wrapper" id="descomposicion">
        
        <div id="main">

            <div id="menu">
                <p>nivel:</p>
                <!--<button class="pulse button" data-id="0">2do, 3ro y 4to</button>
                <div id="submenu"></div>
                <!--<button class="pulse button verde" data-id="1">5to, 6to y 7mo</button>-->
            </div>
            

            

                    

            <div id="content">
              <div id="numero"></div>
              <div class="clear"></div>
              <div id="var">
                  <div id="cardPile"></div>
                  <div id="cardSlots"></div>
              </div>
              <div id="successMessage">
                
              </div>

            </div><!-- content -->
        </div><!-- main -->

         <div id="logos">
          <!--<img class="edinum" src="img/edinun.png" width="50" height="47">-->
          <img class="digiaulas" src="img/digiaulas.png" width="158" height="48">
        </div><!--logos -->

        

         <div id="nav">
            <button id="instrucciones" class="pulse">Instrucciones</button>
            <button id="regresar" class="pulse">Regresar</button>
         </div><!--nav-->
         <img id="titulo" src="img/numerosNaturales.png" width="202" height="94">
         <img id="avatar" src="img/muneco2.png" width="170" height="187">

      </div><!-- contenedor -->
    <script src="js/vendor/jquery-1.5.min.js"></script>
    <script src="js/vendor/jquery-1.8.9.ui.min.js"></script>
    <script src="js/vendor/handlebars.min.js"></script>
    <script src="js/vendor/jquery.shuffle.js"></script>
    
    </body>
</html>
<script id="menuTemplate" type="text/x-handlebars-template">
    <p>nivel:</p>
    <ul> 
        {{#each this}}
            <li class="pulse" data-id="{{id}}">{{texto}}</li>
        {{/each}}
    </ul>    
  </script>

<script type="text/javascript">
  $(start);
  
  function start(){
    var correctCards = 0,
        menuTemplate = $('#menuTemplate'),
        menu = $('#menu'),
        min = 0,
        max = 0,     
        menuItems = [
            { 
              texto: 'Dos dígitos',
              id: '1'
            },   
            { 
              texto: 'Tres dígitos',
              id:'2'
            },
            { 
              texto: 'Cuatro dígitos',
              id:'3'
            },
            { 
              texto: 'Más de cuatro dígitos',
              id:'4'
            }
          ];// var menu
      
      template = Handlebars.compile(menuTemplate.html());
      menu.html(template(menuItems)).hide().fadeIn();

        
      // Hide the success message
      $('#successMessage , #cardPile , #cardSlots , #numero').hide();
      $('#successMessage').css({
          left: '580px',
          top: '250px',
          width: 0,
          height: 0
      });
  

    menu.find('ul > li').live('click', function(){
      var id = $(this).data('id');
      //$('#numero').hide();
      $('#numero, #cardPile , #cardSlots').html('');
        
      switch (id){
          case 1:
          min = 10;
          max = 99;
          words = ['decenas', 'unidades'];
          break;

          case 2:
          min = 99;
          max = 999;
          words = ['centenas','decenas', 'unidades'];
          break;

          case 3:
          min = 99;
          max = 9999;
          words = ['miles','centenas','decenas', 'unidades'];
          break;

          case 4:
          min = 99999;
          max = 999999;
          words = ['CM','DM','UM','C','D', 'U'];
          break;  
        }//swtich
        
        cargarNumeros(min,max, words, id);
        
      }); //menuButtons.click
  }//cargarNumeros


function cargarNumeros(min,max, words, id) {
  //$('#numero').fadeIn();
  $('#content').removeClass().addClass('d'+ id);  

  // Reset the game
  correctCards = 0;
  $('#cardPile , #cardSlots , #numero').html( '' ).fadeIn();
  
  

  // and the formula is:
  var numbers = (Math.floor(Math.random() * (max - min + 1)) + min).toString();
  localStorage.setItem("numbers", numbers);

  $('#numero').html('<p>Forma el número:</p><p id="num">' + numbers + '</p>');
  tempNum = numbers;
  numbers = shuffle(numbers.split(''));

  for ( var i=0; i<numbers.length; i++ ) {
    
    $('<div>' + numbers[i] + '</div>').data( 'number', numbers[i] ).attr( 'id', 'card'+tempNum[i] ).appendTo( '#cardPile' ).draggable( {
      containment: '#content',
      stack: '#cardPile div',
      cursor: 'move',
      revert: true
    } );
  }

  // Create the card slots
  
  for ( var i=1; i<=tempNum.length; i++ ) {
    $('<div>' + words[i - 1] + '</div>').data( 'number', tempNum[i - 1] ).appendTo( '#cardSlots' ).droppable( {
      accept: '#cardPile div',
      hoverClass: 'hovered',
      drop: handleCardDrop
    } );
  }

}//cargarNumeros

function handleCardDrop( event, ui ) {
  var slotNumber = $(this).data( 'number' );
  var cardNumber = ui.draggable.data( 'number' );
  // If the card was dropped to the correct slot,
  // change the card colour, position it directly
  // on top of the slot, and prevent it being dragged
  // again

  if ( slotNumber == cardNumber ) {
    ui.draggable.addClass( 'correct' );
    ui.draggable.draggable( 'disable' );
    $(this).droppable( 'disable' );
    ui.draggable.position( { of: $(this), my: 'left top', at: 'left top' } );
    ui.draggable.draggable( 'option', 'revert', false );
    correctCards++;
  } 
  
  // If all the cards have been placed correctly then display a message
  // and reset the cards for another go

  if ( correctCards == tempNum.length ) {
    $('#successMessage').html('<h2>Bien Hecho! <br/> Presiona el boton y luego uno de los del submenu</h2><button onclick="escribir()">Jugar otra vez</button>')
    .show();
    
    $('#successMessage').animate( {
      left: '380px',
      top: '200px',
      width: '400px',
      height: '250px',
      opacity: 1
    } );
  }//correct

}//handleCardDrop


function escribir(){
    var contenedor =  $('#var');
    contenedor.html('');
    $('#successMessage').hide();

    var value = localStorage.getItem('numbers');
    $('#var').append('<input type="text" name="">');

}


</script>
